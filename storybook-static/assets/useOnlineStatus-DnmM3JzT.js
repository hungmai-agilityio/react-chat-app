import{r as p}from"./index-CTjT7uj6.js";import{g as y,c as o,d as n,q as E,w as m,a as h,s as O,o as g}from"./auth-AY9r89Py.js";import{E as r}from"./endPoint-D9QdfkjO.js";const U=async()=>{try{return{data:(await y(o(n,r.USER))).docs.map(e=>({id:e.id,...e.data()})),error:null}}catch(t){return{data:null,error:t}}},q=async t=>{try{const s=o(n,r.PROFILE),e=E(s,m("user_id","==",t));return{data:(await y(e)).docs.map(a=>({...a.data(),id:a.id}))[0],error:null}}catch(s){return{data:null,error:s}}},w=async(t,s)=>{const e=h(n,r.USER,t);await O(e,{isOnline:s},{merge:!0})},P=t=>{const[s,e]=p.useState({});return p.useEffect(()=>{if(!t)return;const c=async()=>{await w(t,!0)},i=async()=>{await w(t,!1)};c();const a=o(n,r.USER),u=g(a,S=>{const l={};S.forEach(f=>{l[f.id]=f.data().isOnline||!1}),e(l)}),d=async()=>{await i()};return window.addEventListener("beforeunload",d),()=>{u(),window.removeEventListener("beforeunload",d)}},[t]),s};export{q as a,U as g,P as u};
